plot4 <- ggplot(temp,aes(InvestmentType,prc,fill=InvestmentType))+geom_bar(stat="identity")+labs(x="",y="Percentage",title="Investment Type")+geom_label(aes(label=prc))+coord_flip()
plot4
plot4 <- ggplot(temp,aes(InvestmentType,prc,fill=InvestmentType))+geom_bar(stat="identity")+labs(x="",y="Percentage",title="Investment Type")+geom_label(aes(label=prc))+coord_flip()+theme(legend.position="none")
plot4
?ls()
rm(list = ls())
ffr <- read.csv("/Users/StevenTseng/Desktop/NUS /Business Analytics/couresa/R programming/Kaggle/kaggle-survey-2017/freeformResponses.csv")
mcr <- read.csv("/Users/StevenTseng/Desktop/NUS /Business Analytics/couresa/R programming/Kaggle/kaggle-survey-2017/multipleChoiceResponses.csv")
ffr <- str()
ffr <- glimpse()
ffr %>% View()
mcr %>% View()
cr <- read.csv("/Users/StevenTseng/Desktop/NUS /Business Analytics/couresa/R programming/Kaggle/kaggle-survey-2017/conversionRates.csv")
cleanffr <- ffr
cleanffr <- ffr
cleanmcr <- mcr
cleancr <- cr
?filter()
?filter()
sym()
library("tidyverse", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
install.packages(c("backports", "BH", "bindr", "boot", "callr", "curl", "DBI", "dbplyr", "digest", "evaluate", "forcats", "foreign", "haven", "hexbin", "hms", "htmlwidgets", "httpuv", "knitr", "lubridate", "MASS", "Matrix", "mgcv", "nlme", "openssl", "R6", "Rcpp", "reprex", "reshape2", "rlang", "rmarkdown", "rpart", "rprojroot", "selectr", "stringi", "stringr", "tibble", "tidyr", "tidyselect", "viridisLite", "xml2", "yaml"))
columnmean <- function(x){
nc <- ncol(x)
n <- numeric(nc)
for(i in 1:n ){
means[i] <- mean(x[,i])
}
}
source('~/Desktop/NUS /Business Analytics/couresa/R programming/Kaggle/kaggle-survey-2017/KaggleSurvey.R')
qplot(x = displ,y =hwy,data = mpg,color=drv )
library(ggplot2)
library(dplyr)
qplot(x = displ,y =hwy,data = mpg,color=drv )
qplot(x = displ,y =hwy,data = mpg)
qplot(x = displ,y =hwy,data = mpg,geom = smooth)
"smooth
qplot(x = displ,y =hwy,data = mpg,geom = "smooth")
qplot(x = displ,y =hwy,data = mpg,geom =c("smooth"))
qplot(x = displ,y =hwy,data = mpg,geom =c("point","smooth"))
str(mpg)
qplot(hwy,data = mpg,fill=drv)
qplot(displ,hwy,data = mpg,facets = .~drv)
qplot(displ,hwy,data = mpg,facets = drv.~)
qplot(displ,hwy,data = mpg,facets = drv~.)
qplot(x = displ,y = hwy,data = mpg,facets = .~drv,geom = c("point","smooth"),method="lm")
ggplot(mpg,aes(displ,hwy))+geom_point()
ggplot(mpg,aes(displ,hwy),color=drv)+geom_point()
ggplot(mpg,aes(displ,hwy),color=drv)+geom_point()
ggplot(mpg,aes(displ,hwy))+geom_point(color=drv)
ggplot(mpg,aes(displ,hwy),color=drv)+geom_point()
ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth()
ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")
ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth()
ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth("lm")
ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth("lm")
ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth()
ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth("lm")
ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")
ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")+geom_smooth()
ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")+geom_smooth()+facet_grid(.~drv)
ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")+geom_smooth()+facet_grid(drv~.)
ggplot(mpg,aes(displ,hwy),color=facet(drv))+geom_point()+geom_smooth(method = "lm")+geom_smooth()+facet_grid(drv~.)
ggplot(mpg,aes(displ,hwy),color=rv)+geom_point()+geom_smooth(method = "lm")+geom_smooth()+facet_grid(drv~.)
ggplot(mpg,aes(displ,hwy),color=drv)+geom_point()+geom_smooth(method = "lm")+geom_smooth()+facet_grid(drv~.)
ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")+geom_smooth()+facet_grid(drv~.)
ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")+geom_smooth()+facet_grid(~drv)
+labs(x="Displ",y="HWY",title=MPG)
"MPG"
+labs(x="Displ",y="HWY",title="MPG")
+labs(x="Displ",y="HWY")
ggplot(mpg,aes(displ,hwy))
+geom_point()
+geom_smooth(method = "lm")
+geom_smooth()
+facet_grid(~drv)
+labs(x="Displ",y="HWY")
ggplot(mpg,aes(displ,hwy))
+geom_point()
+geom_smooth(method = "lm")
+geom_smooth()
+facet_grid(~drv)
ggplot(mpg,aes(displ,hwy))
+geom_point()
+geom_smooth(method = "lm")
+geom_smooth()
+facet_grid(~drv)
ggplot(mpg,aes(displ,hwy))
+geom_point()
+geom_smooth(method = "lm")
+geom_smooth()
+facet_grid(~drv)
ggplot(mpg,aes(displ,hwy))
+geom_point()
+geom_smooth(method = "lm")
+geom_smooth()
+facet_grid(~drv)
P <- ggplot(mpg,aes(displ,hwy))
+geom_point()
+geom_smooth(method = "lm")
+geom_smooth()
+facet_grid(~drv)
P <- ggplot(mpg,aes(displ,hwy))
+geom_point()
+geom_smooth(method = "lm")
+geom_smooth()
+facet_grid(~drv)
library(ggplot2)
library(dplyr)
qplot(x = displ,y = hwy,data = mpg,facets = .~drv,geom = c("point","smooth"),method="lm")
P <- ggplot(mpg,aes(displ,hwy))
+geom_point()
+geom_smooth(method = "lm")
+geom_smooth()
+facet_grid(~drv)
P <- ggplot(mpg,aes(displ,hwy))
+geom_point()
+geom_smooth(method = "lm")
+geom_smooth()
+facet_grid(~drv)
P <- ggplot(mpg,aes(displ,hwy))
+geom_point()
+geom_smooth(method = "lm")
+geom_smooth()
+facet_grid(~drv)
P <- ggplot(mpg,aes(displ,hwy))
+geom_point()
+geom_smooth(method = "lm")
+geom_smooth()
+facet_grid(~drv)
P <- ggplot(mpg,aes(displ,hwy))
+geom_point()
+geom_smooth(method = "lm")
+geom_smooth()
+facet_grid(~drv)
library(ggplot2)
P <- ggplot(mpg,aes(displ,hwy))
+geom_point()
+geom_smooth(method = "lm")
+geom_smooth()
+facet_grid(~drv)
P <- ggplot(mpg,aes(displ,hwy))
+geom_point()
P <- ggplot(mpg,aes(displ,hwy))
+geom_point()
qplot(x = displ,y = hwy,data = mpg,facets = .~drv,geom = c("point","smooth"),method="lm")
P <- ggplot(mpg,aes(displ,hwy))
+geom_point()
+geom_smooth(method = "lm")
+geom_smooth()
+facet_grid(~drv)
library(ggplot2)
library(dplyr)
qplot(x = displ,y =hwy,data = mpg,geom =c("point","smooth"))
qplot(hwy,data = mpg,fill=drv)
qplot(displ,hwy,data = mpg,facets = drv~.)
P <- ggplot(mpg,aes(displ,hwy))
+geom_point()
+geom_smooth(method = "lm")
+geom_smooth()
+facet_grid(~drv)
P <- ggplot(mpg,aes(displ,hwy))+geom_point()
P <- ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")
P <- ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")+geom_smooth()
P <- ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")+geom_smooth()+facet_grid(~drv)
P
P <- ggplot(mpg,aes(displ,hwy))+geom_point(color=drv)+geom_smooth(method = "lm")+geom_smooth()+facet_grid(~drv)
P <- ggplot(mpg,aes(displ,hwy))+geom_point(color=aes(drv))+geom_smooth(method = "lm")+geom_smooth()+facet_grid(~drv)
P
P
P
P <- ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")+geom_smooth()+facet_grid(~drv)
P
P <- ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")+geom_smooth()+facet_grid(drv~)
P <- ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")+geom_smooth()+facet_grid(drv~)
P
P <- ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")+geom_smooth()+facet_grid(drv~.)
P
P <- ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")+geom_smooth()+facet_grid(.~drv)
P
P <- ggplot(mpg,aes(displ,hwy))+geom_point()
ggplot(mpg,aes(displ,hwy))+geom_point()
ggplot(mpg,aes(displ,hwy))+geom_point(color=aes(drv))
ggplot(mpg,aes(displ,hwy,drv))+geom_point(color=aes(drv))
ggplot(mpg,aes(displ,hwy))+geom_point(color=aes(drv))
ggplot(mpg,aes(displ,hwy))+geom_point(color=drv)
str(mpg)
ggplot(mpg,aes(displ,hwy))+geom_point(color = drv)
qplot(hwy,data = mpg,color=drv)
datset <- data.frame(x=1:100,y=rnorm(100))
datset %>% View()
datset[50,2] <- 100
names(datset)
library(data.table)
ggplot(datset,aes(x,y))+geom_point()
ggplot(datset,aes(x,y))+geom_line()
ggplot(datset,aes(x,y))+geom_line(lims(-3,3))
ggplot(datset,aes(x,y))+geom_line(ylim=c(-3,3))
ggplot(datset,aes(x,y))+geom_line()+ylim(-3,3)
P <- ggplot(mpg,aes(displ,hwy))+geom_point()+geom_smooth(method = "lm")+geom_smooth()+facet_grid(.~drv)+colors(aes(drv))
ggplot(datset,aes(x,y))+geom_line()+ylim(-3,3)
library(dplyr)
library(stats)
library(ggplot2)
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
sub1 <- NEI[,c(4,6)] %>% group_by(year) %>% summarise(n=sum(Emissions))
dat<- merge(SCC,NEI,by = "SCC")
sub1
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
knitr::opts_chunk$set(echo = TRUE)
plot(pressure)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
x <- 1:4
p <- x/sum(x)
temp <- rbind(x, p)
rownames(temp) <- c("X", "Prob")
temp
x*p
x*p %>% sum()
library(dplyr)
x*p %>% sum()
sum(x*p)
sum(x*w) /sum(w)
x <- c(0.18, -1.54, 0.42, 0.95)
w <- c(2, 1, 3, 1)
sum(x*w)/sum(w)
lm(x~y)
lm(x~w)
lm(x~w) %>% class()
l <- lm(x~w)
l$xlevels
l <- lm(w~x)
rbind(x,w)
as.data.frame(rbind(x,w))
l <- lm(w~x)
l$residuals
scale(x)
scale(w)
sw <- scale(w)
sw %>% sum()
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
sum(x*y)/sum(x)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
sum(x*y)/sum(x)
sum(x*y)/sum(x^2)
data(mtcars)
mtcars %>% View()
lm(mtcars$mpg~mtcars$wt)
x <- c(8.58, 10.46, 9.01, 9.64, 8.86)
scale(x)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(y~x)
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
ave(x)
iris
iris_kmeans <- iris[,-5]
iris_kmeans
hclust(iris_kmeans)
hclust(iris_kmeans,method = "complete")
hclust(iris_kmeans,"ward.D")
hclust(iris_kmeans,"ward.D")
is.na(iris_kmeans)
library(stats)
is.na(iris_kmeans) %>% sum()
hclust(iris_kmeans)
dist(iris_kmeans)
dist(iris_kmeans) %>% hclust()
dist(iris_kmeans) %>% hclust() %>% plot()
dist(iris_kmeans)
dist(iris_kmeans) %>% View()
dist(iris_kmeans)
kfit <- kmeans(iris_kmeans,centers = 3)
kfit$cluster
plot(iris_kmeans)
plot(iris_kmeans$Sepal.Length,iris_kmeans$Sepal.Width)
library(ggplot2)
iris_kmeans <- cbind(iris_kmeans,kfit$cluster)
names(iris_kmeans)
ggplot(iris_kmeans,aes(x=Sepal.Length,y=Sepal.Width,fill=kfit$cluster))+geom_point()
ggplot(iris_kmeans,aes(x=Sepal.Length,y=Sepal.Width,color=kfit$cluster))+geom_point()
kfit <- kmeans(iris_kmeans,centers = 3,nstart = 10)
iris_kmeans <- iris[,-5]
iris_kmeans <- cbind(iris_kmeans,kfit$cluster)
ggplot(iris_kmeans,aes(x=Sepal.Length,y=Sepal.Width,color=kfit$cluster))+geom_point()
iris_kmeans <- iris
iris_kmeans <- cbind(iris_kmeans,kfit$cluster)
table(iris_kmeans$Species,iris_kmeans$`kfit$cluster`)
diamonds
diamonds %>% head(5) %>% View()
diamonds %>% names
ggplot(diamonds,aes(x=carat,y=price))+geom_abline()
ggplot(diamonds,aes(x=carat,y=price))+geom_line()
ggplot(diamonds,aes(x=carat,y=price))+geom_point()
ggplot(diamonds,aes(x=carat,y=price))+geom_point()+geom_smooth(method = "lm")
ggplot(diamonds,aes(x=carat,y=price))+ylim(c(0,1000))+geom_point()+geom_smooth(method = "lm")+xlim(c(0,1))
ggplot(diamonds,aes(x=carat,y=price))+geom_point()+geom_smooth(method = "lm")
fit <- lm(price~carat,data = diamonds)
fit
fit$coefficients
summary(fit)
newx <- c(0.16,0.18,0.28)
predict(fit,newdata = newx)
predict(fit,newdata = data.frame(carat=newx))
predict(fit)
fit$residuals
fit$residuals %>% plot
ggplot(fit,aes(x=fit$residuals))+geom_point()
fit$
fit$xlevels
diamonds
dat <- data.frame(x=diamonds$carat,y=fit$residuals)
ggplot(dat,aes(x=x,y=y))+geom_point()
ggplot(dat,aes(x=y))+geom_boxplot()
ggplot(dat,aes(x=y))+geom_boxplot(stat = "identity")
library(dplyr)
library(ggplot2)
library(stringr)
tit <- read.csv("train.csv")
tit$Title <-gsub('(.*, )|(\\..*)',"",x = tit$Name)
tit$Title[tit$Title=="Mlle"] <- "Miss"
tit$Title[tit$Title=="Mme"] <- "Miss"
tit$Title[tit$Title=="Ms"] <- "Mrs"
tit$Title[tit$Title %in% rare_title] <- "Rare Title"
table(tit$Sex,tit$Title)
tit$Fsize <- tit$SibSp+tit$Parch+1
ggplot(tit,aes(x=Fsize,fill=factor(Survived)))+geom_histogram(position = "dodge")+
scale_x_continuous(breaks = c(1:13))+
xlab("family size")
tit$Fsize2 [tit$Fsize==1] <- "singleton"
tit$Fsize2 [tit$Fsize<5 & tit$Fsize>1] <- "small"
tit$Fsize2 [tit$Fsize>=5] <- "large"
ggplot(tit,aes(x=Fsize2,fill=factor(Survived)))+geom_bar(position = "dodge")+
xlab("family size")
tit$Deck <- as.factor(sapply(as.character(tit$Cabin),function(x) strsplit(x,NULL)[[1]][1]))
embark_fare <- tit %>%
filter(PassengerId != 62 & PassengerId != 830)
ggplot(embark_fare,aes(x=Embarked,y=Fare,fill=factor(Pclass)))+
geom_boxplot()+
geom_hline(yintercept =80,color="red",lwd=1.5)
tit$Embarked [c(62,830)] <- "C"
names(tit)
factor_var <- c("PassengerId","Pclass","Sex","Embarked","Title","Fsize")
tit[factor_var] <- tit[factor_var] %>% lapply(function(x) as.factor(x))
set.seed(200)
mice_mod <- mice(tit[,!names(tit) %in% factor_var],method = "rf")
sum(is.na(tit$Age))
require(mice)
library(dplyr)
library(ggplot2)
library(stringr)
setwd("./desktop/titanic.dataset")
tit <- read.csv("train.csv")
tit$Title <-gsub('(.*, )|(\\..*)',"",x = tit$Name)
tit$Title[tit$Title=="Mlle"] <- "Miss"
tit$Title[tit$Title=="Mme"] <- "Miss"
tit$Title[tit$Title=="Ms"] <- "Mrs"
tit$Title[tit$Title %in% rare_title] <- "Rare Title"
table(tit$Sex,tit$Title)
tit$Fsize <- tit$SibSp+tit$Parch+1
ggplot(tit,aes(x=Fsize,fill=factor(Survived)))+geom_histogram(position = "dodge")+
scale_x_continuous(breaks = c(1:13))+
xlab("family size")
tit$Fsize2 [tit$Fsize==1] <- "singleton"
tit$Fsize2 [tit$Fsize<5 & tit$Fsize>1] <- "small"
tit$Fsize2 [tit$Fsize>=5] <- "large"
ggplot(tit,aes(x=Fsize2,fill=factor(Survived)))+geom_bar(position = "dodge")+
xlab("family size")
tit$Deck <- as.factor(sapply(as.character(tit$Cabin),function(x) strsplit(x,NULL)[[1]][1]))
embark_fare <- tit %>%
filter(PassengerId != 62 & PassengerId != 830)
ggplot(embark_fare,aes(x=Embarked,y=Fare,fill=factor(Pclass)))+
geom_boxplot()+
geom_hline(yintercept =80,color="red",lwd=1.5)
tit$Embarked [c(62,830)] <- "C"
factor_var <- c('PassengerId','Pclass','Sex','Embarked',
'Title','Surname','Family','FsizeD')
tit[factor_var] <- tit[factor_var] %>% lapply(function(x) as.factor(x))
tit[factor_var] <- tit[factor_var] %>% lapply(function(x) as.factor(x))
tit[factor_var] <- tit[factor_var] %>% apply(function(x) as.factor(x))
tit[factor_var] <-  apply( tit[factor_var],2,function(x) as.factor(x))
tit[factor_var] <- apply( tit[factor_var],2,function(x) as.factor(x))
factor_var <- c('PassengerId','Pclass','Sex','Embarked',
'Title','Surname','Family','FsizeD')
tit[,factor_var] <- apply( tit[factor_var],2,function(x) as.factor(x))
tit[factor_var]
tit[,factor_var]
factor_var <- c('PassengerId','Pclass','Sex','Embarked','Title','Surname','Family','FsizeD')
tit[factor_var]
tit[,factor_var]
tit[1044, ]
tit %>% View()
sum(is.na(full$Age))
sum(is.na(tit$Age))
tit %>% names
factor_var <- c('PassengerId','Pclass','Sex','Embarked','Title','Surname','Fsize','Fsize2')
tit[factor_var] <-  tit[factor_var]%>% lapply(function(x) as.factor(x))
factor_var <- c('PassengerId','Pclass','Sex','Embarked','Title','Fsize','Fsize2')
tit[factor_var] <-  tit[factor_var]%>% lapply(function(x) as.factor(x))
set.seed(129)
mice_mod <- mice(tit[, !names(tit) %in% c('PassengerId','Name','Ticket','Cabin','Family','Surname','Survived')], method='rf')
require(mice)
mice_mod <- mice(tit[, !names(tit) %in% c('PassengerId','Name','Ticket','Cabin','Family','Surname','Survived')], method='rf')
install.packages("randomForest")
require(randomForest)
mice_mod <- mice(tit[, !names(tit) %in% c('PassengerId','Name','Ticket','Cabin','Family','Surname','Survived')], method='rf')
apply(tit,2,function(x) sum(is.na(x)))
mice_mod
mice_output <- complete(mice_mod)
par(mfrow=c(1,2))
hist(full$Age, freq=F, main='Age: Original Data',
col='darkgreen', ylim=c(0,0.04))
hist(mice_output$Age, freq=F, main='Age: MICE Output',
col='lightgreen', ylim=c(0,0.04))
hist(tit$Age, freq=F, main='Age: Original Data',
col='darkgreen', ylim=c(0,0.04))
# Replace Age variable from the mice model.
full$Age <- mice_output$Age
# Show new number of missing Age values
sum(is.na(full$Age))
mice_output %>% View()
tit$Age <- mice_output$Age
sum(is.na(tit$Age))
ggplot(tit,aes(Age,fill=factor(Survived)))+
geom_bar()
ggplot(tit,aes(Age,fill=factor(Survived)))+
geom_bar()+
facet_grid(.~Sex)
ggplot(tit,aes(Age,fill=factor(Survived)))+
geom_histogram()+
facet_grid(.~Sex)
tit$Child[tit$Age<=18] <- "adult"
tit$Child[tit$Age>18] <- "child"
table(tit$Survived,tit$Child)
# Set a random seed
set.seed(754)
# Build the model (note: not all possible variables are used)
rf_model <- randomForest(factor(Survived) ~ Pclass + Sex + Age +
Fare + Embarked + Title +
Fsize2 + Child ,
data = tit)
# Show model error
plot(rf_model, ylim=c(0,0.36))
legend('topright', colnames(rf_model$err.rate), col=1:3, fill=1:3)
rf_model <- randomForest(factor(Survived) ~ Pclass + Sex + Age + Fare + Embarked + Title + Fsize2 + Child ,data = tit)
tit %>% apply(2,function(x) sum(is.na(x)))
rf_model <- randomForest(factor(Survived) ~ Pclass + Sex + Age + Fare + Embarked + Title + Fsize2 + Child ,data = tit[,-1])
tit[,-1]
tit[,-2]
tit[,-1]
tit1 <- tit %>% drop(Deck)
names(tit)
tit1 <- tit [,-16]
rf_model <- randomForest(factor(Survived) ~ Pclass + Sex + Age + Fare + Embarked + Title + Fsize2 + Child ,data = tit1)
sum(is.na(tit1))
complete.cases(tit1)
complete.cases(tit1) %>% sum()
# Build the model (note: not all possible variables are used)
rf_model <- randomForest(factor(Survived) ~ Pclass + Sex + Age + Fare + Embarked + Title + Fsize2 + Child ,data = tit1)
str(tit1)
tit1$Child <-as.factor(tit1$Child)
rf_model <- randomForest(factor(Survived) ~ Pclass + Sex + Age + Fare + Embarked + Title + Fsize2 + Child ,data = tit1)
# Show model error
plot(rf_model, ylim=c(0,0.36))
legend('topright', colnames(rf_model$err.rate), col=1:3, fill=1:3)
importance(rf_model)
var_importance <- data.frame(Variables=row.names(importance(rf_model)),Importance=round(importance[ ,'MeanDecreaseGini'],2) )
importance <- importance(rf_model)
var_importance <- data.frame(Variables=row.names(importance(rf_model)),Importance=round(importance[ ,'MeanDecreaseGini'],2) )
var_importance
var_importance %>% order(by=Importance)
ggplot(var_importance,aes(x=reorder(Variables,Importance),y=Importance)+
geom_bar(stat = "identity")+
coord_flip()
ggplot(var_importance,aes(x=reorder(Variables,Importance),y=Importance)+
geom_bar(stat = "identity")+
coord_flip()
str(var_importance)
reorder(Variables,Importance)
ggplot(var_importance,aes(x=Variables,y=Importance)+
geom_bar(stat = "identity")+
coord_flip()
ggplot(var_importance,aes(x=Variables,y=Importance)+
geom_bar(stat = "identity")+
coord_flip()
ggplot(var_importance,aes(x=Variables,y=Importance)+
geom_bar(stat = "identity")+
coord_flip()
ggplot(var_importance,aes(x=Variables,y=Importance)+
geom_bar(stat = "identity")+
coord_flip()
ggplot(var_importance,aes(x=Variables,y=Importance)+
geom_bar(stat ="identity")+
coord_flip()
ggplot(var_importance,aes(x=reorder(Variables,Importance),y=Importance))+
geom_bar(stat = "identity")+
coord_flip()
ggplot(var_importance,aes(x=Variables,y=Importance))+
geom_bar(stat = "identity")+
coord_flip()
ggplot(var_importance,aes(x=reorder(Variables,Importance),y=Importance))+
geom_bar(stat = "identity")+
coord_flip()
ggplot(var_importance,aes(x=reorder(Variables,Importance),y=Importance,fill=Importance))+
geom_bar(stat = "identity")+
coord_flip()
